{
  "info": {
    "_postman_id": "crescent-points-v1",
    "name": "Crescent Change – Points API",
    "description": "Complete Points System API for Crescent Change\n\nRoles:\n- **Public** → No auth\n- **Client** → Donor (user)\n- **Admin** → Super Admin / Staff\n- **System** → Internal services only",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Public Endpoints",
      "item": [
        {
          "name": "[Public] Get Leaderboard",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/points/leaderboard?limit=10&tier=gold",
              "host": ["{{baseUrl}}"],
              "path": ["api", "points", "leaderboard"],
              "query": [
                { "key": "limit", "value": "10" },
                { "key": "tier", "value": "gold", "disabled": true }
              ]
            },
            "description": "Anyone can view the public leaderboard"
          }
        }
      ]
    },
    {
      "name": "Client (Donor) Endpoints",
      "item": [
        {
          "name": "[Client] Get My Balance",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{client_token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/points/balance/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "points", "balance", "{{userId}}"]
            },
            "description": "Donor views their current points balance"
          }
        },
        {
          "name": "[Client] Get My Transactions",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{client_token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/points/transactions/{{userId}}?page=1&limit=20&source=donation",
              "host": ["{{baseUrl}}"],
              "path": ["api", "points", "transactions", "{{userId}}"],
              "query": [
                { "key": "page", "value": "1" },
                { "key": "limit", "value": "20" },
                { "key": "source", "value": "donation", "disabled": true }
              ]
            }
          }
        },
        {
          "name": "[Client] Get My Points Summary",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{client_token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/points/summary/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "points", "summary", "{{userId}}"]
            },
            "description": "Balance + last 5 transactions"
          }
        },
        {
          "name": "[Client] Check if I Can Afford Reward",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{client_token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/points/can-afford/{{userId}}?amount=5000",
              "host": ["{{baseUrl}}"],
              "path": ["api", "points", "can-afford", "{{userId}}"],
              "query": [{ "key": "amount", "value": "5000" }]
            }
          }
        }
      ]
    },
    {
      "name": "Admin Endpoints",
      "item": [
        {
          "name": "[Admin] Create Manual Transaction",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{admin_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{userId}}\",\n  \"transactionType\": \"adjusted\",\n  \"amount\": 5000,\n  \"source\": \"admin_adjustment\",\n  \"adjustmentReason\": \"Welcome bonus for new donor\",\n  \"description\": \"Manually added by admin\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/points/transactions",
              "host": ["{{baseUrl}}"],
              "path": ["api", "points", "transactions"]
            }
          }
        },
        {
          "name": "[Admin] Deduct Points (e.g. fraud)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{admin_token}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{userId}}\",\n  \"amount\": 10000,\n  \"source\": \"admin_adjustment\",\n  \"description\": \"Fraudulent donation reversal\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/points/deduct",
              "host": ["{{baseUrl}}"],
              "path": ["api", "points", "deduct"]
            }
          }
        },
        {
          "name": "[Admin] Refund Points",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{admin_token}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{userId}}\",\n  \"amount\": 3000,\n  \"source\": \"reward_redemption\",\n  \"reason\": \"Reward cancelled - out of stock\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/points/refund",
              "host": ["{{baseUrl}}"],
              "path": ["api", "points", "refund"]
            }
          }
        },
        {
          "name": "[Admin] Get Points Statistics",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{admin_token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/points/stats?startDate=2025-01-01&endDate=2025-12-31",
              "host": ["{{baseUrl}}"],
              "path": ["api", "points", "stats"],
              "query": [
                { "key": "startDate", "value": "2025-01-01" },
                { "key": "endDate", "value": "2025-12-31" }
              ]
            },
            "description": "Admin dashboard analytics"
          }
        }
      ]
    },
    {
      "name": "Internal / System Endpoints",
      "item": [
        {
          "name": "[System] Award Points for Donation",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{system_token}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{userId}}\",\n  \"donationId\": \"66f8a1b2c3d4e5f678901234\",\n  \"donationAmount\": 25.50\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/points/award-donation",
              "host": ["{{baseUrl}}"],
              "path": ["api", "points", "award-donation"]
            },
            "description": "Called by Donation Service after successful payment"
          }
        }
      ]
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
  }
}
