{
  "info": {
    "name": "Crescent Change APIs",
    "description": "Complete API collection for Crescent Change donation platform with Authentication, Donations, Payment Methods, Causes, and Stripe integration",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "crescent-change-api",
    "version": "1.0.0"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{accessToken}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:5001/api/v1",
      "type": "string"
    },
    {
      "key": "accessToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "refreshToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "",
      "type": "string"
    },
    {
      "key": "organizationId",
      "value": "",
      "type": "string"
    },
    {
      "key": "causeId",
      "value": "",
      "type": "string"
    },
    {
      "key": "donationId",
      "value": "",
      "type": "string"
    },
    {
      "key": "paymentMethodId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Authentication",
      "description": "User authentication, registration, profile management, and password operations",
      "item": [
        {
          "name": "1. Sign Up",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"SecurePass123!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/signup",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "signup"]
            },
            "description": "Register a new user account. Password must be 8-20 characters with uppercase, lowercase, number, and special character (@$!%*?&#)."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"SecurePass123!\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/auth/signup",
                  "host": ["{{baseUrl}}"],
                  "path": ["auth", "signup"]
                }
              },
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"OTP sent to your email successfully!\",\n  \"data\": {\n    \"_id\": \"64abc123def456\",\n    \"email\": \"user@example.com\",\n    \"role\": \"CLIENT\",\n    \"isVerifiedByOTP\": false,\n    \"otpExpiry\": \"2025-11-11T12:15:00.000Z\",\n    \"createdAt\": \"2025-11-11T12:00:00.000Z\"\n  }\n}"
            }
          ]
        },
        {
          "name": "2. Resend Signup OTP",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/send-signup-otp-again",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "send-signup-otp-again"]
            },
            "description": "Resend OTP code to email for signup verification. Use this if the initial OTP expires or wasn't received."
          },
          "response": []
        },
        {
          "name": "3. Verify Signup OTP",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"otp\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/verify-signup-otp",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "verify-signup-otp"]
            },
            "description": "Verify the 6-digit OTP sent during signup. After verification, user can sign in."
          },
          "response": []
        },
        {
          "name": "4. Sign In",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    if (jsonData.data && jsonData.data.accessToken) {",
                  "        pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
                  "        console.log('✅ Access Token saved');",
                  "    }",
                  "    if (jsonData.data && jsonData.data.refreshToken) {",
                  "        pm.collectionVariables.set('refreshToken', jsonData.data.refreshToken);",
                  "        console.log('✅ Refresh Token saved');",
                  "    }",
                  "    if (jsonData.data && jsonData.data.user && jsonData.data.user._id) {",
                  "        pm.collectionVariables.set('userId', jsonData.data.user._id);",
                  "        console.log('✅ User ID saved: ' + jsonData.data.user._id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"SecurePass123!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/signin",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "signin"]
            },
            "description": "Sign in with email and password. Returns access token (JWT) and refresh token. Automatically saves tokens to collection variables."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"SecurePass123!\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/auth/signin",
                  "host": ["{{baseUrl}}"],
                  "path": ["auth", "signin"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"User signed in successfully!\",\n  \"data\": {\n    \"accessToken\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2NGFiYzEyMyIsInJvbGUiOiJDTElFTlQiLCJpYXQiOjE2MzY1NTIyMjIsImV4cCI6MTYzNjU1NTgyMn0.signature\",\n    \"refreshToken\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2NGFiYzEyMyIsImlhdCI6MTYzNjU1MjIyMiwiZXhwIjoxNjM3MTU3MDIyfQ.signature\",\n    \"user\": {\n      \"_id\": \"64abc123def456\",\n      \"email\": \"user@example.com\",\n      \"role\": \"CLIENT\",\n      \"isProfile\": true,\n      \"isActive\": true\n    }\n  }\n}"
            }
          ]
        },
        {
          "name": "5. Create Profile (Client)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "role",
                  "value": "CLIENT",
                  "type": "text",
                  "description": "User role: CLIENT"
                },
                {
                  "key": "name",
                  "value": "John Doe",
                  "type": "text",
                  "description": "Full name (required for CLIENT)"
                },
                {
                  "key": "address",
                  "value": "123 Main Street",
                  "type": "text",
                  "description": "Street address (required)"
                },
                {
                  "key": "state",
                  "value": "NSW",
                  "type": "text",
                  "description": "State (required)"
                },
                {
                  "key": "postalCode",
                  "value": "2000",
                  "type": "text",
                  "description": "Postal/ZIP code (required)"
                },
                {
                  "key": "nameInCard",
                  "value": "John Doe",
                  "type": "text",
                  "description": "Name as shown on card (required)"
                },
                {
                  "key": "cardNumber",
                  "value": "4242424242424242",
                  "type": "text",
                  "description": "Card number (required)"
                },
                {
                  "key": "cardExpiryDate",
                  "value": "2027-12-31",
                  "type": "text",
                  "description": "Card expiry date YYYY-MM-DD (required)"
                },
                {
                  "key": "cardCVC",
                  "value": "123",
                  "type": "text",
                  "description": "Card CVC/CVV (required)"
                },
                {
                  "key": "clientImage",
                  "type": "file",
                  "src": "",
                  "description": "Profile image (optional)"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/auth/create-Profile",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "create-Profile"]
            },
            "description": "Create user profile for CLIENT role. All fields marked as required must be provided. Upload profile image as multipart/form-data."
          },
          "response": []
        },
        {
          "name": "5. Create Profile (Business)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "role",
                  "value": "BUSINESS",
                  "type": "text"
                },
                {
                  "key": "name",
                  "value": "ABC Corporation",
                  "type": "text",
                  "description": "Business name (required)"
                },
                {
                  "key": "category",
                  "value": "Retail",
                  "type": "text",
                  "description": "Business category (required)"
                },
                {
                  "key": "tagLine",
                  "value": "Quality Products for Everyone",
                  "type": "text",
                  "description": "Business tagline (required)"
                },
                {
                  "key": "description",
                  "value": "Leading retail business providing quality products",
                  "type": "text",
                  "description": "Business description (required)"
                },
                {
                  "key": "businessPhoneNumber",
                  "value": "+61234567890",
                  "type": "text",
                  "description": "Business phone (required)"
                },
                {
                  "key": "businessEmail",
                  "value": "contact@abccorp.com",
                  "type": "text",
                  "description": "Business email (required)"
                },
                {
                  "key": "businessWebsite",
                  "value": "https://abccorp.com",
                  "type": "text",
                  "description": "Business website URL (required)"
                },
                {
                  "key": "locations",
                  "value": "[\"Sydney\", \"Melbourne\", \"Brisbane\"]",
                  "type": "text",
                  "description": "JSON array of locations (required)"
                },
                {
                  "key": "businessImage",
                  "type": "file",
                  "src": "",
                  "description": "Business logo (optional)"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/auth/create-Profile",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "create-Profile"]
            },
            "description": "Create user profile for BUSINESS role with business details and logo."
          },
          "response": []
        },
        {
          "name": "5. Create Profile (Organization)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "role",
                  "value": "ORGANIZATION",
                  "type": "text"
                },
                {
                  "key": "name",
                  "value": "Hope Foundation",
                  "type": "text",
                  "description": "Organization name (required)"
                },
                {
                  "key": "serviceType",
                  "value": "Education",
                  "type": "text",
                  "description": "Service type (required)"
                },
                {
                  "key": "address",
                  "value": "456 Charity Street",
                  "type": "text",
                  "description": "Organization address (required)"
                },
                {
                  "key": "state",
                  "value": "VIC",
                  "type": "text",
                  "description": "State (required)"
                },
                {
                  "key": "postalCode",
                  "value": "3000",
                  "type": "text",
                  "description": "Postal code (required)"
                },
                {
                  "key": "website",
                  "value": "https://hopefoundation.org",
                  "type": "text",
                  "description": "Organization website (required)"
                },
                {
                  "key": "phoneNumber",
                  "value": "+61987654321",
                  "type": "text",
                  "description": "Organization phone (required)"
                },
                {
                  "key": "boardMemberName",
                  "value": "Jane Smith",
                  "type": "text",
                  "description": "Board member name (required)"
                },
                {
                  "key": "boardMemberEmail",
                  "value": "jane@hopefoundation.org",
                  "type": "text",
                  "description": "Board member email (required)"
                },
                {
                  "key": "boardMemberPhoneNumber",
                  "value": "+61987654322",
                  "type": "text",
                  "description": "Board member phone (required)"
                },
                {
                  "key": "nameInCard",
                  "value": "Hope Foundation",
                  "type": "text",
                  "description": "Name on payment card (required)"
                },
                {
                  "key": "cardNumber",
                  "value": "4242424242424242",
                  "type": "text",
                  "description": "Card number (required)"
                },
                {
                  "key": "cardExpiryDate",
                  "value": "2027-12-31",
                  "type": "text",
                  "description": "Card expiry YYYY-MM-DD (required)"
                },
                {
                  "key": "cardCVC",
                  "value": "123",
                  "type": "text",
                  "description": "Card CVC (required)"
                },
                {
                  "key": "tfnOrAbnNumber",
                  "value": "12345678901",
                  "type": "text",
                  "description": "TFN or ABN number (required)"
                },
                {
                  "key": "zakatLicenseHolderNumber",
                  "value": "ZL123456",
                  "type": "text",
                  "description": "Zakat license number (required)"
                },
                {
                  "key": "organizationImage",
                  "type": "file",
                  "src": "",
                  "description": "Organization logo (optional)"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/auth/create-Profile",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "create-Profile"]
            },
            "description": "Create user profile for ORGANIZATION role with complete organization details."
          },
          "response": []
        },
        {
          "name": "6. Update Photo",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "profileImage",
                  "type": "file",
                  "src": "",
                  "description": "Profile photo. Accepts: file, image, photo, profileImage, avatar"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/auth/update-photo",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "update-photo"]
            },
            "description": "Update user profile photo. Accepts various field names: file, image, photo, profileImage, or avatar."
          },
          "response": []
        },
        {
          "name": "7. Change Password",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"oldPassword\": \"SecurePass123!\",\n  \"newPassword\": \"NewSecurePass456!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/change-password",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "change-password"]
            },
            "description": "Change user password. Requires current password for verification. New password must meet security requirements."
          },
          "response": []
        },
        {
          "name": "8. Forgot Password",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/forgot-password",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "forgot-password"]
            },
            "description": "Request password reset. Sends OTP to email and returns a token for the reset flow."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"email\": \"user@example.com\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/auth/forgot-password",
                  "host": ["{{baseUrl}}"],
                  "path": ["auth", "forgot-password"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"OTP sent to your email successfully!\",\n  \"data\": {\n    \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InVzZXJAZXhhbXBsZS5jb20iLCJpYXQiOjE2MzY1NTIyMjIsImV4cCI6MTYzNjU1NTgyMn0.signature\"\n  }\n}"
            }
          ]
        },
        {
          "name": "9. Resend Forgot Password OTP",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/send-forgot-password-otp-again",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "send-forgot-password-otp-again"]
            },
            "description": "Resend OTP for password reset using the token from forgot-password endpoint."
          },
          "response": []
        },
        {
          "name": "10. Verify Forgot Password OTP",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"otp\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/verify-forgot-password-otp",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "verify-forgot-password-otp"]
            },
            "description": "Verify the 6-digit OTP for password reset. OTP must be numeric and exactly 6 digits."
          },
          "response": []
        },
        {
          "name": "11. Reset Password",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"newPassword\": \"NewSecurePass456!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/reset-password",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "reset-password"]
            },
            "description": "Set new password after OTP verification. Password must be 8-20 characters with uppercase, lowercase, number, and special character."
          },
          "response": []
        },
        {
          "name": "12. Get Profile",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/auth/profile",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "profile"]
            },
            "description": "Fetch authenticated user's complete profile information including role-specific data."
          },
          "response": []
        },
        {
          "name": "13. Deactivate Account",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"SecurePass123!\",\n  \"deactivationReason\": \"No longer using the service\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/deactive-account",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "deactive-account"]
            },
            "description": "Temporarily deactivate user account. Requires email, password, and reason (minimum 3 characters). Account can be reactivated later."
          },
          "response": []
        },
        {
          "name": "14. Delete Account",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/auth/delete-account",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "delete-account"]
            },
            "description": "Permanently delete user account from database. This action cannot be undone."
          },
          "response": []
        },
        {
          "name": "15. Refresh Access Token",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [
              {
                "key": "Cookie",
                "value": "refreshToken={{refreshToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/access-token",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "access-token"]
            },
            "description": "Get new access token using refresh token from cookies. Use when access token expires."
          },
          "response": []
        },
        {
          "name": "16. Update Auth Data",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Updated Name\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/update-auth-data",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "update-auth-data"]
            },
            "description": "Update user authentication data such as display name."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Payment Methods",
      "description": "Manage saved payment methods (cards) for donations with Stripe",
      "item": [
        {
          "name": "1. Create Setup Intent",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{baseUrl}}/payment-method/setup-intent",
              "host": ["{{baseUrl}}"],
              "path": ["payment-method", "setup-intent"]
            },
            "description": "Create a Stripe SetupIntent for collecting card payment method. Returns client_secret for frontend card collection using Stripe.js."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "raw",
                  "raw": "{}"
                },
                "url": {
                  "raw": "{{baseUrl}}/payment-method/setup-intent",
                  "host": ["{{baseUrl}}"],
                  "path": ["payment-method", "setup-intent"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Setup intent created successfully for card payment!\",\n  \"data\": {\n    \"client_secret\": \"seti_1234567890_secret_abcdefgh\",\n    \"setup_intent_id\": \"seti_1234567890\"\n  }\n}"
            }
          ]
        },
        {
          "name": "2. Add Payment Method",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    if (jsonData.data && jsonData.data.stripePaymentMethodId) {",
                  "        pm.collectionVariables.set('paymentMethodId', jsonData.data.stripePaymentMethodId);",
                  "        console.log('✅ Payment Method ID saved: ' + jsonData.data.stripePaymentMethodId);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"stripePaymentMethodId\": \"pm_1234567890abcdef\",\n  \"cardHolderName\": \"John Doe\",\n  \"isDefault\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/payment-method",
              "host": ["{{baseUrl}}"],
              "path": ["payment-method"]
            },
            "description": "Save a payment method after Stripe SetupIntent is confirmed on frontend. stripePaymentMethodId must start with 'pm_'. Automatically saves to collection variables."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"stripePaymentMethodId\": \"pm_1234567890abcdef\",\n  \"cardHolderName\": \"John Doe\",\n  \"isDefault\": true\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/payment-method",
                  "host": ["{{baseUrl}}"],
                  "path": ["payment-method"]
                }
              },
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Payment method added successfully!\",\n  \"data\": {\n    \"_id\": \"64xyz123abc\",\n    \"user\": \"64abc123def\",\n    \"stripePaymentMethodId\": \"pm_1234567890abcdef\",\n    \"stripeCustomerId\": \"cus_9876543210\",\n    \"type\": \"card\",\n    \"cardBrand\": \"visa\",\n    \"cardLast4\": \"4242\",\n    \"cardExpMonth\": 12,\n    \"cardExpYear\": 2027,\n    \"cardHolderName\": \"John Doe\",\n    \"isDefault\": true,\n    \"isActive\": true,\n    \"createdAt\": \"2025-11-11T12:00:00.000Z\"\n  }\n}"
            }
          ]
        },
        {
          "name": "3. Get User Payment Methods",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/payment-method?includeInactive=false",
              "host": ["{{baseUrl}}"],
              "path": ["payment-method"],
              "query": [
                {
                  "key": "includeInactive",
                  "value": "false",
                  "description": "Include inactive/deleted payment methods (default: false)"
                }
              ]
            },
            "description": "Get all payment methods for authenticated user. Returns active cards only by default, sorted by default status and creation date."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/payment-method",
                  "host": ["{{baseUrl}}"],
                  "path": ["payment-method"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Payment methods retrieved successfully!\",\n  \"data\": [\n    {\n      \"_id\": \"64xyz123\",\n      \"type\": \"card\",\n      \"cardBrand\": \"visa\",\n      \"cardLast4\": \"4242\",\n      \"cardExpMonth\": 12,\n      \"cardExpYear\": 2027,\n      \"cardHolderName\": \"John Doe\",\n      \"isDefault\": true,\n      \"isActive\": true\n    },\n    {\n      \"_id\": \"64xyz456\",\n      \"type\": \"card\",\n      \"cardBrand\": \"mastercard\",\n      \"cardLast4\": \"5454\",\n      \"cardExpMonth\": 6,\n      \"cardExpYear\": 2026,\n      \"cardHolderName\": \"John Doe\",\n      \"isDefault\": false,\n      \"isActive\": true\n    }\n  ]\n}"
            }
          ]
        },
        {
          "name": "4. Get Default Payment Method",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/payment-method/default",
              "host": ["{{baseUrl}}"],
              "path": ["payment-method", "default"]
            },
            "description": "Get user's default payment method for quick donations."
          },
          "response": []
        },
        {
          "name": "5. Get Payment Method by ID",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/payment-method/:id",
              "host": ["{{baseUrl}}"],
              "path": ["payment-method", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "{{paymentMethodId}}",
                  "description": "Payment method ID"
                }
              ]
            },
            "description": "Get specific payment method details by ID. User must own the payment method."
          },
          "response": []
        },
        {
          "name": "6. Set Default Payment Method",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/payment-method/:id/default",
              "host": ["{{baseUrl}}"],
              "path": ["payment-method", ":id", "default"],
              "variable": [
                {
                  "key": "id",
                  "value": "{{paymentMethodId}}",
                  "description": "Payment method ID to set as default"
                }
              ]
            },
            "description": "Set a payment method as default. Automatically unsets previous default. Only active payment methods can be set as default."
          },
          "response": []
        },
        {
          "name": "7. Delete Payment Method",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/payment-method/:id",
              "host": ["{{baseUrl}}"],
              "path": ["payment-method", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "{{paymentMethodId}}",
                  "description": "Payment method ID to delete"
                }
              ]
            },
            "description": "Delete (soft delete - marks as inactive) a payment method. Detaches from Stripe and marks as inactive in database."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Donations",
      "description": "Create and manage donations with direct payment processing",
      "item": [
        {
          "name": "1. Create One-Time Donation",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    if (jsonData.data && jsonData.data.donation && jsonData.data.donation._id) {",
                  "        pm.collectionVariables.set('donationId', jsonData.data.donation._id);",
                  "        console.log('✅ Donation ID saved: ' + jsonData.data.donation._id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"amount\": 100,\n  \"currency\": \"usd\",\n  \"organizationId\": \"{{organizationId}}\",\n  \"causeId\": \"{{causeId}}\",\n  \"paymentMethodId\": \"pm_1234567890abcdef\",\n  \"specialMessage\": \"Keep up the great work!\",\n  \"connectedAccountId\": \"acct_optional\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/donation/one-time/create",
              "host": ["{{baseUrl}}"],
              "path": ["donation", "one-time", "create"]
            },
            "description": "Create one-time donation with direct payment using saved payment method. Amount must be $1-$10,000. Returns donation record and payment intent details. Payment is processed immediately using Stripe Payment Intents API."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"amount\": 100,\n  \"currency\": \"usd\",\n  \"organizationId\": \"64org123\",\n  \"causeId\": \"64cause456\",\n  \"paymentMethodId\": \"pm_1234567890abcdef\",\n  \"specialMessage\": \"Keep up the great work!\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/donation/one-time/create",
                  "host": ["{{baseUrl}}"],
                  "path": ["donation", "one-time", "create"]
                }
              },
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Donation created and payment initiated successfully\",\n  \"data\": {\n    \"donation\": {\n      \"_id\": \"64don789abc\",\n      \"donor\": \"64user123\",\n      \"organization\": \"64org123\",\n      \"cause\": \"64cause456\",\n      \"amount\": 100,\n      \"currency\": \"USD\",\n      \"status\": \"processing\",\n      \"pointsEarned\": 10000,\n      \"donationType\": \"one-time\",\n      \"specialMessage\": \"Keep up the great work!\",\n      \"stripePaymentIntentId\": \"pi_1234567890\",\n      \"stripeCustomerId\": \"cus_9876543210\",\n      \"createdAt\": \"2025-11-11T12:00:00.000Z\"\n    },\n    \"payment\": {\n      \"clientSecret\": \"pi_1234567890_secret_xyz\",\n      \"paymentIntentId\": \"pi_1234567890\",\n      \"status\": \"processing\"\n    }\n  }\n}"
            }
          ]
        },
        {
          "name": "2. Process Payment for Donation",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"successUrl\": \"https://example.com/success\",\n  \"cancelUrl\": \"https://example.com/cancel\",\n  \"paymentMethodType\": \"card\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/donation/:donationId/payment",
              "host": ["{{baseUrl}}"],
              "path": ["donation", ":donationId", "payment"],
              "variable": [
                {
                  "key": "donationId",
                  "value": "{{donationId}}",
                  "description": "Donation ID to process payment for"
                }
              ]
            },
            "description": "Process payment for an existing donation record using Stripe Checkout Session. Use this for donations without saved payment methods."
          },
          "response": []
        },
        {
          "name": "3. Retry Failed Payment",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/donation/:donationId/retry",
              "host": ["{{baseUrl}}"],
              "path": ["donation", ":donationId", "retry"],
              "variable": [
                {
                  "key": "donationId",
                  "value": "{{donationId}}",
                  "description": "Failed donation ID to retry"
                }
              ]
            },
            "description": "Retry payment for a failed donation. Maximum 3 payment attempts allowed. Creates new payment session."
          },
          "response": []
        },
        {
          "name": "4. Get Donation Full Status",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/donation/:id/status",
              "host": ["{{baseUrl}}"],
              "path": ["donation", ":id", "status"],
              "variable": [
                {
                  "key": "id",
                  "value": "{{donationId}}",
                  "description": "Donation ID"
                }
              ]
            },
            "description": "Get donation with full payment status including payment attempt count, retry availability, and payment intent details."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/donation/:id/status",
                  "host": ["{{baseUrl}}"],
                  "path": ["donation", ":id", "status"],
                  "variable": [
                    {
                      "key": "id",
                      "value": "64don789abc"
                    }
                  ]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"data\": {\n    \"donation\": {\n      \"_id\": \"64don789abc\",\n      \"amount\": 100,\n      \"status\": \"completed\",\n      \"donationType\": \"one-time\",\n      \"pointsEarned\": 10000\n    },\n    \"paymentStatus\": {\n      \"status\": \"completed\",\n      \"lastPaymentAttempt\": \"2025-11-11T12:05:00.000Z\",\n      \"paymentAttempts\": 1,\n      \"canRetry\": false,\n      \"sessionId\": \"cs_test_123\",\n      \"paymentIntentId\": \"pi_1234567890\"\n    }\n  }\n}"
            }
          ]
        },
        {
          "name": "5. Get User Donations",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/donation/user?page=1&limit=10&status=all&donationType=all",
              "host": ["{{baseUrl}}"],
              "path": ["donation", "user"],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "Page number (min: 1, default: 1)"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "Items per page (1-100, default: 10)"
                },
                {
                  "key": "status",
                  "value": "all",
                  "description": "Filter: all, pending, completed, failed, refunded (default: all)"
                },
                {
                  "key": "donationType",
                  "value": "all",
                  "description": "Filter: all, one-time, recurring, round-up (default: all)"
                }
              ]
            },
            "description": "Get paginated list of authenticated user's donations with optional filters by status and donation type."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/donation/user?page=1&limit=10",
                  "host": ["{{baseUrl}}"],
                  "path": ["donation", "user"],
                  "query": [
                    {
                      "key": "page",
                      "value": "1"
                    },
                    {
                      "key": "limit",
                      "value": "10"
                    }
                  ]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Donations retrieved successfully\",\n  \"data\": {\n    \"donations\": [\n      {\n        \"_id\": \"64don789\",\n        \"amount\": 100,\n        \"status\": \"completed\",\n        \"organization\": {\n          \"_id\": \"64org123\",\n          \"name\": \"Hope Foundation\"\n        },\n        \"cause\": {\n          \"_id\": \"64cause456\",\n          \"name\": \"Education for All\"\n        },\n        \"createdAt\": \"2025-11-11T12:00:00.000Z\"\n      }\n    ],\n    \"total\": 25,\n    \"page\": 1,\n    \"totalPages\": 3\n  }\n}"
            }
          ]
        },
        {
          "name": "6. Get Donation by ID",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/donation/:id",
              "host": ["{{baseUrl}}"],
              "path": ["donation", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "{{donationId}}",
                  "description": "Donation ID"
                }
              ]
            },
            "description": "Get specific donation details by ID. User must own the donation or be admin/organization."
          },
          "response": []
        },
        {
          "name": "7. Get Organization Donations",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/donation/organization/:organizationId?page=1&limit=10&status=all&type=all",
              "host": ["{{baseUrl}}"],
              "path": ["donation", "organization", ":organizationId"],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "Page number (default: 1)"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "Items per page (1-100, default: 10)"
                },
                {
                  "key": "status",
                  "value": "all",
                  "description": "Filter by status (default: all)"
                },
                {
                  "key": "type",
                  "value": "all",
                  "description": "Filter by donation type (default: all)"
                }
              ],
              "variable": [
                {
                  "key": "organizationId",
                  "value": "{{organizationId}}",
                  "description": "Organization ID"
                }
              ]
            },
            "description": "Get all donations received by a specific organization. Requires ORGANIZATION or ADMIN role. Includes donor information."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Causes",
      "description": "Manage donation causes for organizations (public and protected endpoints)",
      "item": [
        {
          "name": "1. Get Cause Names (Public)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/cause/names",
              "host": ["{{baseUrl}}"],
              "path": ["cause", "names"]
            },
            "description": "Get list of all cause names for dropdowns/selectors. Public endpoint, no authentication required."
          },
          "response": []
        },
        {
          "name": "2. Create Cause",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    if (jsonData.data && jsonData.data._id) {",
                  "        pm.collectionVariables.set('causeId', jsonData.data._id);",
                  "        console.log('✅ Cause ID saved: ' + jsonData.data._id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Education for All\",\n  \"description\": \"Providing quality education to underprivileged children around the world\",\n  \"organizationId\": \"{{organizationId}}\",\n  \"targetAmount\": 50000,\n  \"category\": \"Education\",\n  \"imageUrl\": \"https://example.com/images/education-cause.jpg\",\n  \"isActive\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cause",
              "host": ["{{baseUrl}}"],
              "path": ["cause"]
            },
            "description": "Create a new cause for an organization. Requires ORGANIZATION or ADMIN role. Automatically saves cause ID to collection variables."
          },
          "response": []
        },
        {
          "name": "3. Get All Causes (Public)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/cause?page=1&limit=10&category=&search=",
              "host": ["{{baseUrl}}"],
              "path": ["cause"],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "Page number (default: 1)"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "Items per page (default: 10)"
                },
                {
                  "key": "category",
                  "value": "",
                  "description": "Filter by category (optional)"
                },
                {
                  "key": "search",
                  "value": "",
                  "description": "Search by name or description (optional)"
                }
              ]
            },
            "description": "Get paginated list of all active causes. Public endpoint with optional category filter and search."
          },
          "response": []
        },
        {
          "name": "4. Get Causes by Organization (Public)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/cause/organization/:organizationId",
              "host": ["{{baseUrl}}"],
              "path": ["cause", "organization", ":organizationId"],
              "variable": [
                {
                  "key": "organizationId",
                  "value": "{{organizationId}}",
                  "description": "Organization ID"
                }
              ]
            },
            "description": "Get all causes for a specific organization. Public endpoint, useful for organization profile pages."
          },
          "response": []
        },
        {
          "name": "5. Get Cause by ID (Public)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/cause/:id",
              "host": ["{{baseUrl}}"],
              "path": ["cause", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "{{causeId}}",
                  "description": "Cause ID"
                }
              ]
            },
            "description": "Get detailed information about a specific cause. Public endpoint for cause detail pages."
          },
          "response": []
        },
        {
          "name": "6. Update Cause",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Updated Cause Name\",\n  \"description\": \"Updated detailed description of the cause\",\n  \"targetAmount\": 75000,\n  \"imageUrl\": \"https://example.com/images/updated-cause.jpg\",\n  \"isActive\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cause/:id",
              "host": ["{{baseUrl}}"],
              "path": ["cause", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "{{causeId}}",
                  "description": "Cause ID to update"
                }
              ]
            },
            "description": "Update cause details. Requires ORGANIZATION or ADMIN role. All fields are optional."
          },
          "response": []
        },
        {
          "name": "7. Delete Cause",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/cause/:id",
              "host": ["{{baseUrl}}"],
              "path": ["cause", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "{{causeId}}",
                  "description": "Cause ID to delete"
                }
              ]
            },
            "description": "Delete a cause. Requires ORGANIZATION or ADMIN role. May fail if donations are linked to this cause."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Stripe",
      "description": "Stripe payment integration endpoints for checkout and refunds",
      "item": [
        {
          "name": "1. Create Checkout Session",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"amount\": 100,\n  \"causeId\": \"{{causeId}}\",\n  \"organizationId\": \"{{organizationId}}\",\n  \"userId\": \"{{userId}}\",\n  \"connectedAccountId\": \"acct_optional\",\n  \"specialMessage\": \"Thank you for your amazing work!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/stripe/checkout-session",
              "host": ["{{baseUrl}}"],
              "path": ["stripe", "checkout-session"]
            },
            "description": "Create Stripe Checkout Session for payment redirect flow. Returns session ID and redirect URL. Use this for donations without saved payment methods."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"amount\": 100,\n  \"causeId\": \"64cause456\",\n  \"organizationId\": \"64org123\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/stripe/checkout-session",
                  "host": ["{{baseUrl}}"],
                  "path": ["stripe", "checkout-session"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Checkout session created successfully!\",\n  \"data\": {\n    \"sessionId\": \"cs_test_1234567890abcdefghijklmnop\",\n    \"url\": \"https://checkout.stripe.com/pay/cs_test_1234567890abcdefghijklmnop\"\n  }\n}"
            }
          ]
        },
        {
          "name": "2. Retrieve Checkout Session",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/stripe/checkout-session/:sessionId",
              "host": ["{{baseUrl}}"],
              "path": ["stripe", "checkout-session", ":sessionId"],
              "variable": [
                {
                  "key": "sessionId",
                  "value": "cs_test_1234567890",
                  "description": "Stripe Checkout Session ID"
                }
              ]
            },
            "description": "Retrieve Stripe Checkout Session details by session ID. Use to verify payment completion after redirect."
          },
          "response": []
        },
        {
          "name": "3. Create Refund",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{accessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"paymentIntentId\": \"pi_1234567890\",\n  \"amount\": 50,\n  \"reason\": \"requested_by_customer\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/stripe/refund",
              "host": ["{{baseUrl}}"],
              "path": ["stripe", "refund"]
            },
            "description": "Create full or partial refund for a payment. Amount is optional - omit for full refund. Requires authentication and proper permissions."
          },
          "response": []
        }
      ]
    }
  ]
}
