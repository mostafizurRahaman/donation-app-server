{
  "info": {
    "_postman_id": "crescent-rewards-v1",
    "name": "Crescent Change – Rewards API",
    "description": "Complete Rewards System API for Crescent Change\n\nRoles:\n- **Public** → No auth\n- **Client** → Donor (user)\n- **Business** → Business/Staff\n- **Admin** → Super Admin / Staff",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Public Endpoints",
      "item": [
        {
          "name": "[Public] Get Featured Rewards",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/rewards/featured?page=1&limit=10",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "featured"],
              "query": [
                { "key": "page", "value": "1" },
                { "key": "limit", "value": "10" }
              ]
            },
            "description": "Get all featured rewards"
          }
        },
        {
          "name": "[Public] Get All Rewards",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/rewards?page=1&limit=20&type=in-store&category=food&status=active&featured=true&search=coffee",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards"],
              "query": [
                { "key": "page", "value": "1" },
                { "key": "limit", "value": "20" },
                { "key": "type", "value": "in-store", "disabled": true },
                { "key": "category", "value": "food", "disabled": true },
                { "key": "status", "value": "active", "disabled": true },
                { "key": "featured", "value": "true", "disabled": true },
                { "key": "search", "value": "coffee", "disabled": true },
                { "key": "sortBy", "value": "createdAt", "disabled": true },
                { "key": "sortOrder", "value": "desc", "disabled": true }
              ]
            },
            "description": "Get all rewards with optional filters:\n- type: in-store, online\n- category: food, clothing, groceries, etc.\n- status: active, inactive, expired, upcoming, sold-out\n- featured: true/false\n- search: text search in title/description"
          }
        },
        {
          "name": "[Public] Get Reward by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/rewards/{{rewardId}}?userId={{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "{{rewardId}}"],
              "query": [
                { "key": "userId", "value": "{{userId}}", "disabled": true }
              ]
            },
            "description": "Get detailed reward information. Optional userId to check user-specific data (balance, claims)"
          }
        },
        {
          "name": "[Public] Check Reward Availability",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/rewards/{{rewardId}}/availability?userId={{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "{{rewardId}}", "availability"],
              "query": [
                { "key": "userId", "value": "{{userId}}", "disabled": true }
              ]
            },
            "description": "Check if reward is available for claiming. Returns availability status, remaining count, and user-specific info if userId provided"
          }
        },
        {
          "name": "[Public] Get Rewards by Business",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/rewards/business/{{businessId}}?page=1&limit=20&status=active",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "business", "{{businessId}}"],
              "query": [
                { "key": "page", "value": "1" },
                { "key": "limit", "value": "20" },
                { "key": "status", "value": "active", "disabled": true }
              ]
            },
            "description": "Get all rewards for a specific business"
          }
        }
      ]
    },
    {
      "name": "Client (Donor) Endpoints",
      "item": [
        {
          "name": "[Client] Claim Reward",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{client_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"preferredCodeType\": \"discount\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/rewards/{{rewardId}}/claim",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "{{rewardId}}", "claim"]
            },
            "description": "Claim a reward - deducts points and assigns code/QR. Returns redemption details and assigned code if applicable."
          }
        },
        {
          "name": "[Client] Get My Claimed Rewards",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{client_token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/rewards/my/claimed?page=1&limit=20&includeExpired=false",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "my", "claimed"],
              "query": [
                { "key": "page", "value": "1" },
                { "key": "limit", "value": "20" },
                { "key": "includeExpired", "value": "false" },
                { "key": "sortBy", "value": "claimedAt", "disabled": true },
                { "key": "sortOrder", "value": "desc", "disabled": true }
              ]
            },
            "description": "Get user's claimed rewards (wallet). Set includeExpired=true to see expired claims."
          }
        },
        {
          "name": "[Client] Get Claimed Reward Details",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{client_token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/rewards/redemption/{{redemptionId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "redemption", "{{redemptionId}}"]
            },
            "description": "Get details of a specific claimed reward including QR code, assigned code, expiry date, etc."
          }
        },
        {
          "name": "[Client] Cancel Claimed Reward",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{client_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"Changed my mind - will claim later\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/rewards/redemption/{{redemptionId}}/cancel",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "rewards",
                "redemption",
                "{{redemptionId}}",
                "cancel"
              ]
            },
            "description": "Cancel a claimed reward and get points refunded. Only available within 24 hours of claiming."
          }
        }
      ]
    },
    {
      "name": "Business Endpoints",
      "item": [
        {
          "name": "[Business] Create Reward (In-Store)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{business_token}}" }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "businessId",
                  "value": "{{businessId}}",
                  "type": "text"
                },
                {
                  "key": "title",
                  "value": "Free Coffee & Pastry",
                  "type": "text"
                },
                {
                  "key": "description",
                  "value": "Enjoy a free coffee and pastry of your choice. Valid at all our locations.",
                  "type": "text"
                },
                { "key": "type", "value": "in-store", "type": "text" },
                { "key": "category", "value": "food", "type": "text" },
                { "key": "redemptionLimit", "value": "100", "type": "text" },
                {
                  "key": "inStoreRedemptionMethods[qrCode]",
                  "value": "true",
                  "type": "text"
                },
                {
                  "key": "inStoreRedemptionMethods[staticCode]",
                  "value": "true",
                  "type": "text"
                },
                { "key": "featured", "value": "true", "type": "text" },
                {
                  "key": "rewardImage",
                  "type": "file",
                  "src": "/path/to/reward-image.jpg"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/rewards",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards"]
            },
            "description": "Create an in-store reward. Codes are auto-generated based on redemptionLimit."
          }
        },
        {
          "name": "[Business] Create Reward (Online)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{business_token}}" }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "businessId",
                  "value": "{{businessId}}",
                  "type": "text"
                },
                {
                  "key": "title",
                  "value": "$25 Gift Card",
                  "type": "text"
                },
                {
                  "key": "description",
                  "value": "Redeem this $25 gift card online or in-store.",
                  "type": "text"
                },
                { "key": "type", "value": "online", "type": "text" },
                { "key": "category", "value": "other", "type": "text" },
                {
                  "key": "onlineRedemptionMethods[giftCard]",
                  "value": "true",
                  "type": "text"
                },
                {
                  "key": "onlineRedemptionMethods[discountCode]",
                  "value": "true",
                  "type": "text"
                },
                { "key": "featured", "value": "false", "type": "text" },
                {
                  "key": "rewardImage",
                  "type": "file",
                  "src": "/path/to/reward-image.jpg"
                },
                {
                  "key": "codesFiles",
                  "type": "file",
                  "src": "/path/to/codes.csv"
                },
                {
                  "key": "codesFiles",
                  "type": "file",
                  "src": "/path/to/more-codes.csv"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/rewards",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards"]
            },
            "description": "Create an online reward. Requires CSV file(s) with codes/gift card URLs.\n\nCSV Format:\ncode\nDISCOUNT123\nDISCOUNT456\n\nOR for gift cards:\ncode\nhttps://giftcard.example.com/abc123\nhttps://giftcard.example.com/def456"
          }
        },
        {
          "name": "[Business] Update Reward",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Authorization", "value": "Bearer {{business_token}}" }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "title",
                  "value": "Updated Reward Title",
                  "type": "text"
                },
                {
                  "key": "description",
                  "value": "Updated description",
                  "type": "text"
                },
                { "key": "redemptionLimit", "value": "150", "type": "text" },
                {
                  "key": "updateReason",
                  "value": "Increasing limit due to high demand",
                  "type": "text"
                },
                { "key": "featured", "value": "true", "type": "text" },
                {
                  "key": "rewardImage",
                  "type": "file",
                  "src": "/path/to/new-image.jpg",
                  "disabled": true
                },
                {
                  "key": "codesFiles",
                  "type": "file",
                  "src": "/path/to/additional-codes.csv",
                  "disabled": true
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/rewards/{{rewardId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "{{rewardId}}"]
            },
            "description": "Update reward details. Can add new codes for online rewards. Limit updates have 24h cooldown."
          }
        },
        {
          "name": "[Business] Update Reward Image Only",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Authorization", "value": "Bearer {{business_token}}" }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "rewardImage",
                  "type": "file",
                  "src": "/path/to/new-image.jpg"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/rewards/{{rewardId}}/image",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "{{rewardId}}", "image"]
            },
            "description": "Update only the reward image"
          }
        },
        {
          "name": "[Business] Upload Additional Codes",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{business_token}}" }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "files",
                  "type": "file",
                  "src": "/path/to/codes1.csv"
                },
                {
                  "key": "files",
                  "type": "file",
                  "src": "/path/to/codes2.csv"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/rewards/{{rewardId}}/codes",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "{{rewardId}}", "codes"]
            },
            "description": "Upload additional codes to existing online reward. Supports multiple CSV files."
          }
        },
        {
          "name": "[Business] Delete Reward (Soft Delete)",
          "request": {
            "method": "DELETE",
            "header": [
              { "key": "Authorization", "value": "Bearer {{business_token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/rewards/{{rewardId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "{{rewardId}}"]
            },
            "description": "Soft delete reward - sets status to inactive. Can be reactivated."
          }
        },
        {
          "name": "[Business] Redeem Claimed Reward",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{business_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"location\": \"Main Street Store\",\n  \"notes\": \"Customer presented QR code at checkout\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/rewards/redemption/{{redemptionId}}/redeem",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "rewards",
                "redemption",
                "{{redemptionId}}",
                "redeem"
              ]
            },
            "description": "Mark a claimed reward as redeemed (used). Called when customer presents QR/code at store."
          }
        },
        {
          "name": "[Business] Verify Redemption by Code",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{business_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"ABC123XYZ\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/rewards/redemption/verify",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "redemption", "verify"]
            },
            "description": "Verify a redemption by code or redemptionId. Returns user and reward details if valid."
          }
        },
        {
          "name": "[Business] Get Reward Statistics",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{business_token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/rewards/analytics/stats?businessId={{businessId}}&startDate=2025-01-01&endDate=2025-12-31",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "analytics", "stats"],
              "query": [
                { "key": "businessId", "value": "{{businessId}}" },
                {
                  "key": "startDate",
                  "value": "2025-01-01",
                  "disabled": true
                },
                {
                  "key": "endDate",
                  "value": "2025-12-31",
                  "disabled": true
                }
              ]
            },
            "description": "Get comprehensive reward statistics including top rewards, categories, redemption rates, etc."
          }
        }
      ]
    },
    {
      "name": "Admin Endpoints",
      "item": [
        {
          "name": "[Admin] Archive Reward (Hard Delete)",
          "request": {
            "method": "DELETE",
            "header": [
              { "key": "Authorization", "value": "Bearer {{admin_token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/rewards/{{rewardId}}/archive",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "{{rewardId}}", "archive"]
            },
            "description": "Permanently delete reward from database. Admin only. Cannot be undone."
          }
        },
        {
          "name": "[Admin] Get All Reward Statistics",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{admin_token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/rewards/analytics/stats?startDate=2025-01-01&endDate=2025-12-31",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards", "analytics", "stats"],
              "query": [
                {
                  "key": "startDate",
                  "value": "2025-01-01",
                  "disabled": true
                },
                {
                  "key": "endDate",
                  "value": "2025-12-31",
                  "disabled": true
                }
              ]
            },
            "description": "Get platform-wide reward statistics (all businesses)"
          }
        },
        {
          "name": "[Admin] Create Reward for Any Business",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{admin_token}}" }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "businessId",
                  "value": "{{businessId}}",
                  "type": "text"
                },
                {
                  "key": "title",
                  "value": "Admin Created Reward",
                  "type": "text"
                },
                {
                  "key": "description",
                  "value": "Special reward created by admin",
                  "type": "text"
                },
                { "key": "type", "value": "in-store", "type": "text" },
                { "key": "category", "value": "other", "type": "text" },
                { "key": "redemptionLimit", "value": "50", "type": "text" },
                {
                  "key": "inStoreRedemptionMethods[qrCode]",
                  "value": "true",
                  "type": "text"
                },
                { "key": "featured", "value": "true", "type": "text" }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/rewards",
              "host": ["{{baseUrl}}"],
              "path": ["api", "rewards"]
            },
            "description": "Admin can create rewards for any business"
          }
        }
      ]
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:5000",
      "type": "string"
    },
    {
      "key": "client_token",
      "value": "your_client_jwt_token",
      "type": "string"
    },
    {
      "key": "business_token",
      "value": "your_business_jwt_token",
      "type": "string"
    },
    {
      "key": "admin_token",
      "value": "your_admin_jwt_token",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "66f8a1b2c3d4e5f678901234",
      "type": "string"
    },
    {
      "key": "businessId",
      "value": "66f8a1b2c3d4e5f678905678",
      "type": "string"
    },
    {
      "key": "rewardId",
      "value": "66f8a1b2c3d4e5f678909999",
      "type": "string"
    },
    {
      "key": "redemptionId",
      "value": "66f8a1b2c3d4e5f678908888",
      "type": "string"
    }
  ]
}
