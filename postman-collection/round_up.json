{
  "info": {
    "_postman_id": "a1b2c3d4-e5f6-a7b8-c9d0-e1f2a3b4c5d6",
    "name": "RoundUp API Collection",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "RoundUp Management",
      "item": [
        {
          "name": "Create RoundUp Configuration (Save Consent)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"bankConnectionId\": \"635fec4f7c5e5e3c7c5e5e3c\",\n  \"organizationId\": \"635fec4f7c5e5e3c7c5e5e3d\",\n  \"causeId\": \"635fec4f7c5e5e3c7c5e5e3e\",\n  \"monthlyThreshold\": 20,\n  \"specialMessage\": \"My automatic round-up donation!\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/secure-roundup/consent/save",
              "host": ["{{baseUrl}}"],
              "path": ["secure-roundup", "consent", "save"]
            },
            "description": "Sets up a new round-up configuration for a user after they've connected a bank account."
          },
          "response": []
        },
        {
          "name": "Get User Dashboard",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/secure-roundup/dashboard",
              "host": ["{{baseUrl}}"],
              "path": ["secure-roundup", "dashboard"]
            },
            "description": "Retrieves the dashboard information for the authenticated user, including their round-up settings and stats."
          },
          "response": []
        },
        {
          "name": "Manually Process Monthly Donation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"roundUpId\": \"635fec4f7c5e5e3c7c5e5e3f\",\n  \"specialMessage\": \"Manual donation for this month.\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/secure-roundup/process-monthly-donation",
              "host": ["{{baseUrl}}"],
              "path": ["secure-roundup", "process-monthly-donation"]
            },
            "description": "Manually triggers a donation for the current month's accumulated round-ups."
          },
          "response": []
        },
        {
          "name": "Resume Paused RoundUp",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"roundUpId\": \"635fec4f7c5e5e3c7c5e5e3f\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/secure-roundup/resume",
              "host": ["{{baseUrl}}"],
              "path": ["secure-roundup", "resume"]
            },
            "description": "Resumes a round-up configuration that was previously paused."
          },
          "response": []
        },
        {
          "name": "Switch Charity",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"roundUpId\": \"635fec4f7c5e5e3c7c5e5e3f\",\n    \"newOrganizationId\": \"635fec4f7c5e5e3c7c5e5e40\",\n    \"newCauseId\": \"635fec4f7c5e5e3c7c5e5e41\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/secure-roundup/charity/switch",
              "host": ["{{baseUrl}}"],
              "path": ["secure-roundup", "charity", "switch"]
            },
            "description": "Switches the target charity for a round-up configuration. Subject to a 30-day rule."
          },
          "response": []
        },
        {
          "name": "Revoke Consent",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/secure-roundup/consent/revoke/:bankConnectionId",
              "host": ["{{baseUrl}}"],
              "path": [
                "secure-roundup",
                "consent",
                "revoke",
                ":bankConnectionId"
              ],
              "variable": [
                {
                  "key": "bankConnectionId",
                  "value": "635fec4f7c5e5e3c7c5e5e3c"
                }
              ]
            },
            "description": "Revokes consent, disconnects the bank account via Plaid, and deactivates the round-up."
          },
          "response": []
        }
      ]
    },
    {
      "name": "RoundUp Transactions",
      "item": [
        {
          "name": "Get User Transactions (Filtered & Paginated)",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/roundup-transactions?status=processed&page=1&limit=20",
              "host": ["{{baseUrl}}"],
              "path": ["roundup-transactions"],
              "query": [
                {
                  "key": "status",
                  "value": "processed",
                  "description": "(Optional) Filter by status: pending, processed, processing, donated, failed"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "month",
                  "value": "11",
                  "disabled": true
                },
                {
                  "key": "year",
                  "value": "2025",
                  "disabled": true
                }
              ]
            },
            "description": "Retrieves a list of the user's round-up transactions with filtering and pagination."
          },
          "response": []
        },
        {
          "name": "Get Transaction Summary",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/roundup-transactions/summary",
              "host": ["{{baseUrl}}"],
              "path": ["roundup-transactions", "summary"]
            },
            "description": "Gets a summary of the user's round-up transactions, including counts by status and monthly totals."
          },
          "response": []
        },
        {
          "name": "Get Transaction Details",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/roundup-transactions/:transactionId",
              "host": ["{{baseUrl}}"],
              "path": ["roundup-transactions", ":transactionId"],
              "variable": [
                {
                  "key": "transactionId",
                  "value": "txn_12345"
                }
              ]
            },
            "description": "Retrieves the details of a single round-up transaction."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Admin",
      "item": [
        {
          "name": "Test RoundUp Processing Cron (Manual Trigger)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"userId\": \"635fec4f7c5e5e3c7c5e5e3a\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/secure-roundup/test-cron-processing",
              "host": ["{{baseUrl}}"],
              "path": ["secure-roundup", "test-cron-processing"]
            },
            "description": "**ADMIN ONLY**\n\nManually triggers the round-up processing cron job. \n\n- Provide a `userId` to process for a single user.\n- Send an empty body `{}` to process for all active users."
          },
          "response": []
        },
        {
          "name": "Get Admin Dashboard",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/secure-roundup/admin/dashboard",
              "host": ["{{baseUrl}}"],
              "path": ["secure-roundup", "admin", "dashboard"]
            },
            "description": "**ADMIN ONLY**\n\nRetrieves system-wide statistics for the admin dashboard."
          },
          "response": []
        }
      ]
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{authToken}}",
        "type": "string"
      }
    ]
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:5000/api/v1",
      "type": "string"
    }
  ]
}
